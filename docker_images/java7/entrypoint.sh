#!/bin/sh

if [ "$DISABLE_TRUST_URL" == "True" ]; then
    sed -i "s/trustURLCodebase\", \"true\"/trustURLCodebase\", \"false\"/g" /app_source/src/main/java/com/log4j/vuln/poc/PocApplication.java
    cat /app_source/src/main/java/com/log4j/vuln/poc/PocApplication.java
fi

sed "s/{{LOG4J_VERSION}}/$LOG4J_VERSION/g" /app_source/pom.xml.template > /app_source/pom.xml
mvn clean install -q -f /app_source/pom.xml -Dmaven.test.skip
java -jar /app_source/target/poc-0.0.1-SNAPSHOT.jar
