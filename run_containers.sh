#!/bin/bash

export $(cat .env | xargs)

echo "Creating containers"

docker network create -d bridge the_internet

docker run --network the_internet -p "8080:8080" --name spring-boot-app --env LOG4J_VERSION=${LOG4J_VERSION} poc:${JAVA_VERSION} &
docker run --network the_internet --name marshalsec marshalsec &
docker run --network the_internet -p "8888:80" --name exploit-http-server --env LOG4J_VERSION=${LOG4J_VERSION} exploit_nginx &
docker run --network the_internet  --name curl_attacker --env PAYLOAD=${PAYLOAD} -v ${PWD}/exploits.sh:/exploits.sh curler
